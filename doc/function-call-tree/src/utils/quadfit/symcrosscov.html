<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of symcrosscov</title>
  <meta name="keywords" content="symcrosscov">
  <meta name="description" content="Compensation for observation cross-covariance matrix.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- # src --><!-- ../menu.html utils --><!-- menu.html quadfit -->
<h1>symcrosscov
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>Compensation for observation cross-covariance matrix.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function C = symcrosscov(phi1, phi2, sysvars) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> Compensation for observation cross-covariance matrix.

 Given a sample data covariance matrix D = E( phi1 * phi2' ) of noisy
 observations, compute the noise compensation C such that C = D - D0
 where D0 is based on noise-free observations.

 Input arguments:
 phi1, phi2:
    a vector of terms to compute the cross-covariance of, e.g. [x x^2 y],
    or a polynomial system equation, e.g. 2*x+4*x^2+6*y

 Output arguments:
 C:
    a cross-covariance matrix as a function of noise variances and (means
    of) noisy observatons, e.g. sigma_x, sigma_y, x, y, x.^2

 Example:
 Compute the cross-covariance compensation for following vectors observed
 with noise: phi = [x^2 x*y y^2 x y] and epsilon = [x y]

 &gt;&gt; x = sympoly(symvariable('x'));
 &gt;&gt; y = sympoly(symvariable('y'));
 &gt;&gt; symcrosscov([x^2 x*y y^2 x y], [x y]);
 [ 3*sigma_x^2*x    sigma_x^2*y ]
 [   sigma_x^2*y    sigma_y^2*x ]
 [   sigma_y^2*x  3*sigma_y^2*y ]
 [     sigma_x^2              0 ]
 [             0      sigma_y^2 ]

 This implies that the cross-covariance compensation for cov(x^2,x) is
 3*sigma_x^2*mean(x), i.e. cov(x^2,x)-cov(x0^2,x0) = 3*sigma_x^2*mean(x).</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="sympoly.html" class="code" title="">sympoly</a>	</li><li><a href="symvariable.html" class="code" title="">symvariable</a>	</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="quadmake.html" class="code" title="function quadmake(kind)">quadmake</a>	Builds covariance matrices for quadratic forms.</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function C = symcrosscov(phi1, phi2, sysvars)</a>
0002 <span class="comment">% Compensation for observation cross-covariance matrix.</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% Given a sample data covariance matrix D = E( phi1 * phi2' ) of noisy</span>
0005 <span class="comment">% observations, compute the noise compensation C such that C = D - D0</span>
0006 <span class="comment">% where D0 is based on noise-free observations.</span>
0007 <span class="comment">%</span>
0008 <span class="comment">% Input arguments:</span>
0009 <span class="comment">% phi1, phi2:</span>
0010 <span class="comment">%    a vector of terms to compute the cross-covariance of, e.g. [x x^2 y],</span>
0011 <span class="comment">%    or a polynomial system equation, e.g. 2*x+4*x^2+6*y</span>
0012 <span class="comment">%</span>
0013 <span class="comment">% Output arguments:</span>
0014 <span class="comment">% C:</span>
0015 <span class="comment">%    a cross-covariance matrix as a function of noise variances and (means</span>
0016 <span class="comment">%    of) noisy observatons, e.g. sigma_x, sigma_y, x, y, x.^2</span>
0017 <span class="comment">%</span>
0018 <span class="comment">% Example:</span>
0019 <span class="comment">% Compute the cross-covariance compensation for following vectors observed</span>
0020 <span class="comment">% with noise: phi = [x^2 x*y y^2 x y] and epsilon = [x y]</span>
0021 <span class="comment">%</span>
0022 <span class="comment">% &gt;&gt; x = sympoly(symvariable('x'));</span>
0023 <span class="comment">% &gt;&gt; y = sympoly(symvariable('y'));</span>
0024 <span class="comment">% &gt;&gt; symcrosscov([x^2 x*y y^2 x y], [x y]);</span>
0025 <span class="comment">% [ 3*sigma_x^2*x    sigma_x^2*y ]</span>
0026 <span class="comment">% [   sigma_x^2*y    sigma_y^2*x ]</span>
0027 <span class="comment">% [   sigma_y^2*x  3*sigma_y^2*y ]</span>
0028 <span class="comment">% [     sigma_x^2              0 ]</span>
0029 <span class="comment">% [             0      sigma_y^2 ]</span>
0030 <span class="comment">%</span>
0031 <span class="comment">% This implies that the cross-covariance compensation for cov(x^2,x) is</span>
0032 <span class="comment">% 3*sigma_x^2*mean(x), i.e. cov(x^2,x)-cov(x0^2,x0) = 3*sigma_x^2*mean(x).</span>
0033 
0034 <span class="comment">% Copyright 2009-2011 Levente Hunyadi</span>
0035 
0036 <span class="comment">% data covariance matrix (including noise contribution)</span>
0037 <span class="keyword">if</span> numel(phi1) &gt; 1
0038     t1 = phi1;
0039 <span class="keyword">else</span>
0040     [t1,~] = terms(phi1);  <span class="comment">% drop term coefficients</span>
0041 <span class="keyword">end</span>
0042 <span class="keyword">if</span> numel(phi2) &gt; 1
0043     t2 = phi2;
0044 <span class="keyword">else</span>
0045     [t2,~] = terms(phi2);
0046 <span class="keyword">end</span>
0047 D = t1(:) * t2(:)';
0048 
0049 <span class="keyword">if</span> nargin &lt; 3
0050     <span class="comment">% variables in system</span>
0051     sysvars = union(variables(phi1), variables(phi2));
0052 <span class="keyword">end</span>
0053 
0054 <span class="comment">% variables in noise-free data covariance matrix</span>
0055 vars = sysvars;
0056 <span class="keyword">for</span> k = 1 : numel(sysvars)
0057     vars(k) = copy(sysvars(k), [ sysvars(k).Name <span class="string">'0'</span> ]);  <span class="comment">% e.g. u0[k-1]</span>
0058 <span class="keyword">end</span>
0059 
0060 <span class="comment">% noise-free data covariance matrix</span>
0061 D0 = renamevars(D, sysvars, vars);
0062 
0063 <span class="comment">% noise covariance matrix</span>
0064 C = D - D0;
0065 
0066 <span class="comment">% express expected value of noise contribution in terms of noise</span>
0067 <span class="comment">% covariances and noisy observations</span>
0068 <span class="keyword">for</span> i = 1 : numel(t2)
0069     <span class="keyword">for</span> j = 1 : numel(t1)
0070         s = C(j,i);
0071         <span class="keyword">for</span> k = 1 : numel(D(j,i).Variables)
0072             <span class="comment">% noisy data in D are expressed in terms of noise variances and</span>
0073             <span class="comment">% lower-order noise-free data, e.g. x^3 = x0^3 + 3*sigma_x^2*x0</span>
0074             <span class="comment">% sigma_x: standard deviation of noise contribution</span>
0075             <span class="comment">% x, x0:   expected value of noisy and noise-free sequence</span>
0076             var = D(j,i).Variables(k);               <span class="comment">% e.g. u[k-1]</span>
0077             <span class="keyword">if</span> ~any(var == sysvars)
0078                 <span class="keyword">continue</span>;  <span class="comment">% skip variables that denote constants</span>
0079             <span class="keyword">end</span>
0080             
0081             polyvar = <a href="sympoly.html" class="code" title="">sympoly</a>(var);
0082 
0083             <span class="comment">% express noisy data in terms of noise-free data and noise;</span>
0084             <span class="comment">% by construction, highest-degree noise-free term is canceled</span>
0085             vartrue = copy(var, [ var.Name <span class="string">'0'</span> ]);   <span class="comment">% e.g. u0[k-1]</span>
0086             polytrue = <a href="sympoly.html" class="code" title="">sympoly</a>(vartrue);
0087             varnoise = copy(var, [ var.Name <span class="string">'n'</span> ]);  <span class="comment">% e.g. un[k-1]</span>
0088             polynoise = <a href="sympoly.html" class="code" title="">sympoly</a>(varnoise);
0089             s = subs(s, polyvar, polytrue + polynoise);
0090 
0091             <span class="comment">% take expectation for noise contributions</span>
0092             sigma = <a href="symvariable.html" class="code" title="">symvariable</a>([<span class="string">'sigma_'</span> var.Name]);     <span class="comment">% e.g. sigma_u for u[k-1]</span>
0093             polysigma = <a href="sympoly.html" class="code" title="">sympoly</a>(sigma);
0094             s = errorprop(s, varnoise, 0, polysigma);
0095 
0096             <span class="comment">% eliminate lower-degree noise-free data using noisy data</span>
0097             <span class="comment">% e.g. x0 --&gt; x, x0^2 --&gt; x^2 - sigma_x^2, etc.</span>
0098             p = degree(s, vartrue);
0099             <span class="keyword">while</span> p &gt; 0
0100                 e = errorprop((polytrue + polynoise)^p - polytrue^p, varnoise, 0, polysigma);
0101                 s = subspower(s, polytrue^p, polyvar^p - e);  <span class="comment">% substitute (x - xn) in place of x0</span>
0102                 p = degree(s, vartrue);
0103             <span class="keyword">end</span>
0104         <span class="keyword">end</span>
0105         C(j,i) = s;
0106     <span class="keyword">end</span>
0107 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Tue 10-Jul-2018 15:03:35 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>