<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of pqdist</title>
  <meta name="keywords" content="pqdist">
  <meta name="description" content="Distance of point(s) and quadratic curve or quadric surface.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- # src --><!-- ../menu.html utils --><!-- menu.html quadfit -->
<h1>pqdist
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>Distance of point(s) and quadratic curve or quadric surface.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function [dst,X] = pqdist(Y, a, b, c) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> Distance of point(s) and quadratic curve or quadric surface.
 The quadratic curve (ellipse, parabola, hyperbola, etc.) or quadric
 surface (ellipsoid, elliptic paraboloid, hyperbolic paraboloid,
 hyperboloid, cone, elliptic cylinder, hyperbolic cylinder, parabolic
 cylinder, etc.) is given with the general quadratic equation
 Q(x) = x'*A*x + b'*x + c = 0
 where a pseudo-MatLab notation has been used, N = 2 for plane and N = 3
 for space. The parameter x is an N-by-1 column vector. Those points x
 that satisfy Q(x) = 0 comprise the quadratic curve or quadric surface.

 Input arguments:
 Y:
    a column vector whose distance to the curve or surface to compute, or
    a matrix of such column vectors
 -- -- --
 A:
    a symmetric N-by-N matrix (N = 2 or N = 3 not necessarily invertible)
 b:
    b is an N-by-1 column vector
 c:
    a scalar
 -- OR --
 p:
    a 6-element (for N = 2) or 10-element (for N = 3) parameter vector for
    components x^2 xy y^2 x y 1 and x^2 y^2 z^2 x*y x*z y*z x y z 1,
    respectively.
 -- -- --

 Output arguments:
 dst:
    the distance between the point(s) Y and the curve or surface
 X:
    a column vector of the foot point of Y on the curve or surface, or
    a matrix of such column vectors

 References:
 David Eberly, Distance from Point to a General Quadratic Curve or a
    General Quadric Surface,
    http://www.geometrictools.com/Documentation/DistancePointToQuadratic.pdf</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../../src/@y/y.html" class="code" title="">y</a>	</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="example_pqdist.html" class="code" title="function example_pqdist">example_pqdist</a>	Sample code for distance of quadratic curve and point.</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function poly = pqdist2(d, alpha, beta, c)</a></li><li><a href="#_sub2" class="code">function poly = pqdist3(d, alpha, beta, c)</a></li><li><a href="#_sub3" class="code">function [mindst,x] = pqdistroots(y, A, b, poly)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [dst,X] = pqdist(Y, a, b, c)</a>
0002 <span class="comment">% Distance of point(s) and quadratic curve or quadric surface.</span>
0003 <span class="comment">% The quadratic curve (ellipse, parabola, hyperbola, etc.) or quadric</span>
0004 <span class="comment">% surface (ellipsoid, elliptic paraboloid, hyperbolic paraboloid,</span>
0005 <span class="comment">% hyperboloid, cone, elliptic cylinder, hyperbolic cylinder, parabolic</span>
0006 <span class="comment">% cylinder, etc.) is given with the general quadratic equation</span>
0007 <span class="comment">% Q(x) = x'*A*x + b'*x + c = 0</span>
0008 <span class="comment">% where a pseudo-MatLab notation has been used, N = 2 for plane and N = 3</span>
0009 <span class="comment">% for space. The parameter x is an N-by-1 column vector. Those points x</span>
0010 <span class="comment">% that satisfy Q(x) = 0 comprise the quadratic curve or quadric surface.</span>
0011 <span class="comment">%</span>
0012 <span class="comment">% Input arguments:</span>
0013 <span class="comment">% Y:</span>
0014 <span class="comment">%    a column vector whose distance to the curve or surface to compute, or</span>
0015 <span class="comment">%    a matrix of such column vectors</span>
0016 <span class="comment">% -- -- --</span>
0017 <span class="comment">% A:</span>
0018 <span class="comment">%    a symmetric N-by-N matrix (N = 2 or N = 3 not necessarily invertible)</span>
0019 <span class="comment">% b:</span>
0020 <span class="comment">%    b is an N-by-1 column vector</span>
0021 <span class="comment">% c:</span>
0022 <span class="comment">%    a scalar</span>
0023 <span class="comment">% -- OR --</span>
0024 <span class="comment">% p:</span>
0025 <span class="comment">%    a 6-element (for N = 2) or 10-element (for N = 3) parameter vector for</span>
0026 <span class="comment">%    components x^2 xy y^2 x y 1 and x^2 y^2 z^2 x*y x*z y*z x y z 1,</span>
0027 <span class="comment">%    respectively.</span>
0028 <span class="comment">% -- -- --</span>
0029 <span class="comment">%</span>
0030 <span class="comment">% Output arguments:</span>
0031 <span class="comment">% dst:</span>
0032 <span class="comment">%    the distance between the point(s) Y and the curve or surface</span>
0033 <span class="comment">% X:</span>
0034 <span class="comment">%    a column vector of the foot point of Y on the curve or surface, or</span>
0035 <span class="comment">%    a matrix of such column vectors</span>
0036 <span class="comment">%</span>
0037 <span class="comment">% References:</span>
0038 <span class="comment">% David Eberly, Distance from Point to a General Quadratic Curve or a</span>
0039 <span class="comment">%    General Quadric Surface,</span>
0040 <span class="comment">%    http://www.geometrictools.com/Documentation/DistancePointToQuadratic.pdf</span>
0041 
0042 <span class="comment">% Copyright 2010 Levente Hunyadi</span>
0043 
0044 validateattributes(Y, {<span class="string">'numeric'</span>}, {<span class="string">'2d'</span>});
0045 <span class="keyword">if</span> isvector(Y)  <span class="comment">% a single point</span>
0046     validateattributes(Y, {<span class="string">'numeric'</span>}, {<span class="string">'column'</span>}, mfilename, <span class="string">'Y'</span>);
0047 <span class="keyword">end</span>
0048 
0049 <span class="keyword">if</span> nargin &gt; 2
0050     validateattributes(a, {<span class="string">'numeric'</span>}, {<span class="string">'2d'</span>}, mfilename, <span class="string">'A'</span>);
0051     A = a;
0052     dim = size(a,1);
0053     validateattributes(dim, {<span class="string">'numeric'</span>}, {<span class="string">'&gt;='</span>, 2, <span class="string">'&lt;='</span>, 3});
0054     validateattributes(a, {<span class="string">'numeric'</span>}, {<span class="string">'2d'</span>,<span class="string">'size'</span>,[dim,dim]}, mfilename, <span class="string">'A'</span>);
0055     validateattributes(b, {<span class="string">'numeric'</span>}, {<span class="string">'column'</span>,<span class="string">'size'</span>,[dim,1]}, mfilename, <span class="string">'b'</span>);
0056     validateattributes(c, {<span class="string">'numeric'</span>}, {<span class="string">'scalar'</span>}, mfilename, <span class="string">'c'</span>);
0057 <span class="keyword">else</span>
0058     validateattributes(a, {<span class="string">'numeric'</span>}, {<span class="string">'nonempty'</span>,<span class="string">'vector'</span>}, mfilename, <span class="string">'p'</span>);
0059     p = a;
0060     <span class="keyword">switch</span> numel(p)
0061         <span class="keyword">case</span> 6  <span class="comment">% quadratic curve, x^2 xy y^2 x y 1</span>
0062             dim = 2;
0063             A = [p(1) 0.5*p(2) ; 0.5*p(2) p(3)];
0064             b = [p(4) ; p(5)];
0065             c = p(6);
0066         <span class="keyword">case</span> 10  <span class="comment">% quadric surface, x^2 y^2 z^2 x*y x*z y*z x y z 1</span>
0067             dim = 3;
0068             A = [ p(1), 0.5*p(4), 0.5*p(5) <span class="keyword">...</span>
0069                 ; 0.5*p(4), p(2), 0.5*p(6) <span class="keyword">...</span>
0070                 ; 0.5*p(5), 0.5*p(6), p(3) <span class="keyword">...</span>
0071                 ];
0072             b = [p(7) ; p(8) ; p(9)];
0073             c = p(10);
0074         <span class="keyword">otherwise</span>
0075             error(<span class="string">'pqdist:DimensionMismatch'</span>, <span class="string">'Unsupported parameter vector dimension numel(p) = %d.'</span>, numel(p));
0076     <span class="keyword">end</span>
0077 <span class="keyword">end</span>
0078 
0079 <span class="keyword">if</span> rcond(A) &lt; 1e-8  <span class="comment">% degenerate quadratic curve/surface: line/plane</span>
0080     <span class="comment">%dst = b' * Y + c;  % row vector of signed distances</span>
0081     <span class="comment">%X = Y - b * dst;</span>
0082     <span class="comment">%return;</span>
0083 <span class="keyword">end</span>
0084 
0085 [R,D] = eig(A);
0086 d = diag(D);
0087 alpha = R'*Y;
0088 beta = R'*b;
0089 
0090 n = size(Y,2);
0091 X = zeros(size(Y));
0092 dst = zeros(1,n);
0093 
0094 <span class="keyword">switch</span> dim
0095     <span class="keyword">case</span> 2  
0096         <span class="keyword">for</span> k = 1 : n
0097             [dst(k),X(:,k)] = <a href="#_sub3" class="code" title="subfunction [mindst,x] = pqdistroots(y, A, b, poly)">pqdistroots</a>(Y(:,k), A, b, <a href="#_sub1" class="code" title="subfunction poly = pqdist2(d, alpha, beta, c)">pqdist2</a>(d, alpha(:,k), beta, c));
0098         <span class="keyword">end</span>
0099     <span class="keyword">case</span> 3  
0100         <span class="keyword">for</span> k = 1 : n
0101             [dst(k),X(:,k)] = <a href="#_sub3" class="code" title="subfunction [mindst,x] = pqdistroots(y, A, b, poly)">pqdistroots</a>(Y(:,k), A, b, <a href="#_sub2" class="code" title="subfunction poly = pqdist3(d, alpha, beta, c)">pqdist3</a>(d, alpha(:,k), beta, c));
0102         <span class="keyword">end</span>
0103 <span class="keyword">end</span>
0104 
0105 <a name="_sub1" href="#_subfunctions" class="code">function poly = pqdist2(d, alpha, beta, c)</a>
0106 <span class="comment">% Distance polynomial of a single 2D point w.r.t. a quadratic curve.</span>
0107 
0108 poly = <span class="keyword">...</span><span class="comment">  % quadratic curve, polynomial coefficients precomputed with pqdistpoly</span>
0109     [ - 4*beta(1)^2*d(1)*d(2)^2 - 4*beta(2)^2*d(1)^2*d(2) + 16*c*d(1)^2*d(2)^2 <span class="keyword">...</span><span class="comment"> % t^4</span>
0110     ; 4*beta(1)^2*d(1)*d(2) - beta(2)*(4*beta(2)*d(1)^2 + 8*beta(2)*d(2)*d(1)) - beta(1)*(4*beta(1)*d(2)^2 + 8*beta(1)*d(1)*d(2)) + 4*beta(2)^2*d(1)*d(2) + 16*c*d(1)*d(2)^2 + 16*c*d(1)^2*d(2) <span class="keyword">...</span><span class="comment"> % t^3</span>
0111     ; alpha(1)*(4*beta(1)*d(2)^2 + 8*beta(1)*d(1)*d(2)) + alpha(2)*(4*beta(2)*d(1)^2 + 8*beta(2)*d(2)*d(1)) - beta(1)*(2*beta(1)*d(1) + 4*beta(1)*d(2)) - beta(2)*(4*beta(2)*d(1) + 2*beta(2)*d(2)) + beta(1)^2*d(1) + beta(2)^2*d(2) + 4*c*d(1)^2 + 4*c*d(2)^2 + 4*alpha(1)^2*d(1)*d(2)^2 + 4*alpha(2)^2*d(1)^2*d(2) + 16*c*d(1)*d(2) - 8*alpha(1)*beta(1)*d(1)*d(2) - 8*alpha(2)*beta(2)*d(1)*d(2) <span class="keyword">...</span><span class="comment"> % t^2</span>
0112     ; 4*c*d(1) + 4*c*d(2) + alpha(1)*(2*beta(1)*d(1) + 4*beta(1)*d(2)) + alpha(2)*(4*beta(2)*d(1) + 2*beta(2)*d(2)) - beta(1)^2 - beta(2)^2 - 2*alpha(1)*beta(1)*d(1) - 2*alpha(2)*beta(2)*d(2) + 4*alpha(1)^2*d(1)*d(2) + 4*alpha(2)^2*d(1)*d(2) <span class="keyword">...</span><span class="comment"> % t</span>
0113     ; d(1)*alpha(1)^2 + beta(1)*alpha(1) + d(2)*alpha(2)^2 + beta(2)*alpha(2) + c <span class="keyword">...</span><span class="comment"> % 1</span>
0114     ];
0115 
0116 <a name="_sub2" href="#_subfunctions" class="code">function poly = pqdist3(d, alpha, beta, c)</a>
0117 <span class="comment">% Distance polynomial of a single 3D point w.r.t. a quadric surface.</span>
0118 
0119 poly = <span class="keyword">...</span><span class="comment">  % quadric surface</span>
0120     [ - 16*beta(1)^2*d(1)*d(2)^2*d(3)^2 - 16*beta(2)^2*d(1)^2*d(2)*d(3)^2 - 16*beta(3)^2*d(1)^2*d(2)^2*d(3) + 64*c*d(1)^2*d(2)^2*d(3)^2 <span class="keyword">...</span>
0121     ; 4*d(3)^2*(16*c*d(1)^2*d(2) + 16*c*d(1)*d(2)^2) - beta(1)*(4*d(3)^2*(4*beta(1)*d(2)^2 + 8*beta(1)*d(1)*d(2)) + 32*beta(1)*d(1)*d(2)^2*d(3)) - beta(2)*(4*d(3)^2*(4*beta(2)*d(1)^2 + 8*beta(2)*d(2)*d(1)) + 32*beta(2)*d(1)^2*d(2)*d(3)) + beta(1)^2*(16*d(1)*d(2)^2*d(3) + 16*d(1)*d(2)*d(3)^2) + beta(2)^2*(16*d(2)*d(1)^2*d(3) + 16*d(2)*d(1)*d(3)^2) + beta(3)^2*(16*d(3)*d(1)^2*d(2) + 16*d(3)*d(1)*d(2)^2) - beta(3)*(2*d(3)*(16*beta(3)*d(1)^2*d(2) + 16*beta(3)*d(1)*d(2)^2) + 16*beta(3)*d(1)^2*d(2)^2) + 64*c*d(1)^2*d(2)^2*d(3) <span class="keyword">...</span>
0122     ; alpha(2)*(4*d(3)^2*(4*beta(2)*d(1)^2 + 8*beta(2)*d(2)*d(1)) + 32*beta(2)*d(1)^2*d(2)*d(3)) + alpha(1)*(4*d(3)^2*(4*beta(1)*d(2)^2 + 8*beta(1)*d(1)*d(2)) + 32*beta(1)*d(1)*d(2)^2*d(3)) - beta(2)*(4*d(3)*(4*beta(2)*d(1)^2 + 8*beta(2)*d(2)*d(1)) + 4*d(3)^2*(4*beta(2)*d(1) + 2*beta(2)*d(2)) + 8*beta(2)*d(1)^2*d(2)) - beta(1)*(4*d(3)*(4*beta(1)*d(2)^2 + 8*beta(1)*d(1)*d(2)) + 4*d(3)^2*(2*beta(1)*d(1) + 4*beta(1)*d(2)) + 8*beta(1)*d(1)*d(2)^2) + 4*d(3)^2*(4*c*d(1)^2 + 16*c*d(1)*d(2) + 4*c*d(2)^2) + beta(1)^2*(4*d(1)*d(2)^2 + 16*d(1)*d(2)*d(3) + 4*d(1)*d(3)^2) + beta(2)^2*(4*d(2)*d(1)^2 + 16*d(2)*d(1)*d(3) + 4*d(2)*d(3)^2) + beta(3)^2*(4*d(3)*d(1)^2 + 16*d(3)*d(1)*d(2) + 4*d(3)*d(2)^2) + alpha(3)*(2*d(3)*(16*beta(3)*d(1)^2*d(2) + 16*beta(3)*d(1)*d(2)^2) + 16*beta(3)*d(1)^2*d(2)^2) - beta(3)*(2*d(3)*(4*beta(3)*d(1)^2 + 16*beta(3)*d(1)*d(2) + 4*beta(3)*d(2)^2) + 16*beta(3)*d(1)*d(2)^2 + 16*beta(3)*d(1)^2*d(2)) + 4*d(3)*(16*c*d(1)^2*d(2) + 16*c*d(1)*d(2)^2) + 16*c*d(1)^2*d(2)^2 - 2*alpha(1)*beta(1)*(16*d(1)*d(2)^2*d(3) + 16*d(1)*d(2)*d(3)^2) - 2*alpha(2)*beta(2)*(16*d(2)*d(1)^2*d(3) + 16*d(2)*d(1)*d(3)^2) - 2*alpha(3)*beta(3)*(16*d(3)*d(1)^2*d(2) + 16*d(3)*d(1)*d(2)^2) + 16*alpha(1)^2*d(1)*d(2)^2*d(3)^2 + 16*alpha(2)^2*d(1)^2*d(2)*d(3)^2 + 16*alpha(3)^2*d(1)^2*d(2)^2*d(3) <span class="keyword">...</span>
0123     ; alpha(2)*(4*d(3)*(4*beta(2)*d(1)^2 + 8*beta(2)*d(2)*d(1)) + 4*d(3)^2*(4*beta(2)*d(1) + 2*beta(2)*d(2)) + 8*beta(2)*d(1)^2*d(2)) + alpha(1)*(4*d(3)*(4*beta(1)*d(2)^2 + 8*beta(1)*d(1)*d(2)) + 4*d(3)^2*(2*beta(1)*d(1) + 4*beta(1)*d(2)) + 8*beta(1)*d(1)*d(2)^2) - beta(3)*(2*d(3)*(4*beta(3)*d(1) + 4*beta(3)*d(2)) + 4*beta(3)*d(1)^2 + 4*beta(3)*d(2)^2 + 16*beta(3)*d(1)*d(2)) - beta(2)*(4*d(3)*(4*beta(2)*d(1) + 2*beta(2)*d(2)) + 4*beta(2)*d(1)^2 + 4*beta(2)*d(3)^2 + 8*beta(2)*d(1)*d(2)) - beta(1)*(4*d(3)*(2*beta(1)*d(1) + 4*beta(1)*d(2)) + 4*beta(1)*d(2)^2 + 4*beta(1)*d(3)^2 + 8*beta(1)*d(1)*d(2)) + alpha(1)^2*(16*d(1)*d(2)^2*d(3) + 16*d(1)*d(2)*d(3)^2) + alpha(2)^2*(16*d(2)*d(1)^2*d(3) + 16*d(2)*d(1)*d(3)^2) + alpha(3)^2*(16*d(3)*d(1)^2*d(2) + 16*d(3)*d(1)*d(2)^2) + alpha(3)*(2*d(3)*(4*beta(3)*d(1)^2 + 16*beta(3)*d(1)*d(2) + 4*beta(3)*d(2)^2) + 16*beta(3)*d(1)*d(2)^2 + 16*beta(3)*d(1)^2*d(2)) + 4*d(3)*(4*c*d(1)^2 + 16*c*d(1)*d(2) + 4*c*d(2)^2) + 4*d(3)^2*(4*c*d(1) + 4*c*d(2)) + beta(1)^2*(4*d(1)*d(2) + 4*d(1)*d(3)) + beta(2)^2*(4*d(1)*d(2) + 4*d(2)*d(3)) + beta(3)^2*(4*d(1)*d(3) + 4*d(2)*d(3)) - 2*alpha(1)*beta(1)*(4*d(1)*d(2)^2 + 16*d(1)*d(2)*d(3) + 4*d(1)*d(3)^2) - 2*alpha(2)*beta(2)*(4*d(2)*d(1)^2 + 16*d(2)*d(1)*d(3) + 4*d(2)*d(3)^2) - 2*alpha(3)*beta(3)*(4*d(3)*d(1)^2 + 16*d(3)*d(1)*d(2) + 4*d(3)*d(2)^2) + 16*c*d(1)*d(2)^2 + 16*c*d(1)^2*d(2) <span class="keyword">...</span>
0124     ; alpha(1)^2*(4*d(1)*d(2)^2 + 16*d(1)*d(2)*d(3) + 4*d(1)*d(3)^2) + alpha(2)^2*(4*d(2)*d(1)^2 + 16*d(2)*d(1)*d(3) + 4*d(2)*d(3)^2) + alpha(3)^2*(4*d(3)*d(1)^2 + 16*d(3)*d(1)*d(2) + 4*d(3)*d(2)^2) + alpha(3)*(2*d(3)*(4*beta(3)*d(1) + 4*beta(3)*d(2)) + 4*beta(3)*d(1)^2 + 4*beta(3)*d(2)^2 + 16*beta(3)*d(1)*d(2)) + alpha(2)*(4*d(3)*(4*beta(2)*d(1) + 2*beta(2)*d(2)) + 4*beta(2)*d(1)^2 + 4*beta(2)*d(3)^2 + 8*beta(2)*d(1)*d(2)) + alpha(1)*(4*d(3)*(2*beta(1)*d(1) + 4*beta(1)*d(2)) + 4*beta(1)*d(2)^2 + 4*beta(1)*d(3)^2 + 8*beta(1)*d(1)*d(2)) + 4*d(3)*(4*c*d(1) + 4*c*d(2)) + beta(1)^2*d(1) + beta(2)^2*d(2) + beta(3)^2*d(3) + 4*c*d(1)^2 + 4*c*d(2)^2 + 4*c*d(3)^2 - beta(1)*(2*beta(1)*d(1) + 4*beta(1)*d(2) + 4*beta(1)*d(3)) - beta(2)*(4*beta(2)*d(1) + 2*beta(2)*d(2) + 4*beta(2)*d(3)) - beta(3)*(4*beta(3)*d(1) + 4*beta(3)*d(2) + 2*beta(3)*d(3)) + 16*c*d(1)*d(2) - 2*alpha(1)*beta(1)*(4*d(1)*d(2) + 4*d(1)*d(3)) - 2*alpha(2)*beta(2)*(4*d(1)*d(2) + 4*d(2)*d(3)) - 2*alpha(3)*beta(3)*(4*d(1)*d(3) + 4*d(2)*d(3)) <span class="keyword">...</span>
0125     ; 4*c*d(1) + 4*c*d(2) + 4*c*d(3) + alpha(1)*(2*beta(1)*d(1) + 4*beta(1)*d(2) + 4*beta(1)*d(3)) + alpha(2)*(4*beta(2)*d(1) + 2*beta(2)*d(2) + 4*beta(2)*d(3)) + alpha(3)*(4*beta(3)*d(1) + 4*beta(3)*d(2) + 2*beta(3)*d(3)) - beta(1)^2 - beta(2)^2 - beta(3)^2 + alpha(1)^2*(4*d(1)*d(2) + 4*d(1)*d(3)) + alpha(2)^2*(4*d(1)*d(2) + 4*d(2)*d(3)) + alpha(3)^2*(4*d(1)*d(3) + 4*d(2)*d(3)) - 2*alpha(1)*beta(1)*d(1) - 2*alpha(2)*beta(2)*d(2) - 2*alpha(3)*beta(3)*d(3) <span class="keyword">...</span>
0126     ; d(1)*alpha(1)^2 + beta(1)*alpha(1) + d(2)*alpha(2)^2 + beta(2)*alpha(2) + d(3)*alpha(3)^2 + beta(3)*alpha(3) + c <span class="keyword">...</span>
0127     ];
0128 
0129 <a name="_sub3" href="#_subfunctions" class="code">function [mindst,x] = pqdistroots(y, A, b, poly)</a>
0130 <span class="comment">% Distance and foot point of a point w.r.t. a quadratic curve or quadric.</span>
0131 
0132 t = roots(poly);
0133 t(abs(imag(t)) &gt; 1e-16) = [];          <span class="comment">% remove complex roots</span>
0134 dim = numel(<a href="../../../src/@y/y.html" class="code" title="">y</a>);
0135 f = zeros(dim, numel(t));              <span class="comment">% candidate foot points</span>
0136 dst = zeros(1, numel(t));
0137 <span class="keyword">for</span> k = 1 : numel(t)                   <span class="comment">% compute foot point for each solution of t, f = inv(I + 2*t*A) * (y - t*b)</span>
0138     f(:,k) = (eye(dim,dim) + 2*t(k)*A) \ (<a href="../../../src/@y/y.html" class="code" title="">y</a> - t(k)*b);
0139     dst(k) = sum((<a href="../../../src/@y/y.html" class="code" title="">y</a> - f(:,k)).^2);     <span class="comment">% squared distance</span>
0140 <span class="keyword">end</span>
0141 [minsqdst,ix] = min(dst);
0142 mindst = sqrt(minsqdst);
0143 x = f(:,ix);                           <span class="comment">% foot point with smallest distance to y</span></pre></div>
<hr><address>Generated on Tue 10-Jul-2018 15:03:35 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>